<!DOCTYPE html>
<html lang="no" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>Datasett-status â€“ Kolumbus / Rogaland</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="dashboard-version" content="{{VERSION}}" />
  <meta name="dashboard-hash" content="{{HASH}}" />

  <link rel="stylesheet" href="dashboard/assets/dashboard.css" />
</head>
<body>
  <div class="page">
    <header class="header">
      <div class="title-wrap">
        <div class="pill pill-live kpi-animate">
          <span class="pill-dot"></span>
          LIVE DATA PIPELINE
        </div>
        <h1 class="page-title kpi-animate">
          Status â€“ Kolumbus &amp; Rogaland speed limits
        </h1>
        <p class="subtitle">
          Oversikt over siste oppdateringer, datamengde og deploy-status for frontend og datasett.
        </p>
      </div>

      <div class="header-controls">
        <div class="header-meta kpi-animate">
          <span>
            <span class="dot" id="global-status-dot"></span>
            <span id="global-status-text">Leser statusâ€¦</span>
          </span>
          <span>
            â±ï¸ Siste deploy:
            <span id="last-deploy-human">â€“</span>
          </span>
          <span>
            ğŸ” Auto-refresh:
            <span id="refresh-countdown">â€“</span>
          </span>
        </div>

        <button class="btn-toggle-theme" id="theme-toggle" type="button">
          <span class="theme-icon theme-icon-dark">ğŸŒ™</span>
          <span class="theme-icon theme-icon-light">â˜€ï¸</span>
          <span class="theme-label">Tema</span>
        </button>
      </div>
    </header>

    <main class="main">
      <section class="grid">
        <!-- Venstre: Datasett -->
        <article class="card card-datasets kpi-animate">
          <div class="card-inner">
            <div class="card-header">
              <h2>Datasett-oversikt</h2>
              <div class="badge" id="datasets-badge">
                <span class="badge-dot" id="datasets-badge-dot"></span>
                <span id="datasets-badge-text">Initâ€¦</span>
              </div>
            </div>
            <div class="card-body">
              <div class="kpi-row">
                <div class="kpi">
                  <div class="kpi-label">Speedlimits</div>
                  <div class="kpi-value" id="sl-files">â€“</div>
                  <div class="kpi-sub" id="sl-size">Filer / stÃ¸rrelse ukjent</div>
                </div>
                <div class="kpi">
                  <div class="kpi-label">Kolumbus realtime</div>
                  <div class="kpi-value" id="ko-count">â€“</div>
                  <div class="kpi-sub" id="ko-updated">Sist oppdatert: â€“</div>
                </div>
                <div class="kpi">
                  <div class="kpi-label">Siste data-hash</div>
                  <div class="kpi-value mono" id="hash-short">â€“</div>
                  <div class="kpi-sub" id="hash-sub">full hash vises under</div>
                </div>
              </div>

              <div class="status-tag" id="freshness-tag">
                <span class="status-dot" id="freshness-dot"></span>
                <span id="freshness-text">Sjekker samtidighet mellom datasettâ€¦</span>
              </div>

              <div class="hash-box mono" id="hash-full">
                Leser meta/last_hash.txtâ€¦
              </div>
            </div>
          </div>
        </article>

        <!-- HÃ¸yre: Pipeline / logg -->
        <article class="card card-pipeline kpi-animate">
          <div class="card-inner">
            <div class="card-header">
              <h2>Deploy &amp; pipeline-status</h2>
              <div class="badge" id="deploy-badge">
                <span class="badge-dot" id="deploy-badge-dot"></span>
                <span id="deploy-badge-text">Initâ€¦</span>
              </div>
            </div>
            <div class="card-body">
              <div class="kpi-row">
                <div class="kpi">
                  <div class="kpi-label">Siste deploy</div>
                  <div class="kpi-value" id="deploy-time">â€“</div>
                  <div class="kpi-sub" id="deploy-age">â€“</div>
                </div>
                <div class="kpi">
                  <div class="kpi-label">Pipeline-status</div>
                  <div class="kpi-value" id="pipeline-state">â€“</div>
                  <div class="kpi-sub" id="pipeline-detail">â€“</div>
                </div>
              </div>

              <div class="log" id="log">
                [init] Venter pÃ¥ dataâ€¦
              </div>

              <div class="legend">
                <span><span class="status-dot"></span> OK</span>
                <span><span class="status-dot status-dot-warn"></span> Varsel</span>
                <span><span class="status-dot status-dot-err"></span> Feil</span>
              </div>
            </div>
          </div>
        </article>
      </section>

      <!-- Nederste rad -->
      <section class="card card-system kpi-animate">
        <div class="card-inner">
          <div class="card-header">
            <h2>Systemdetaljer</h2>
          </div>
          <div class="card-body">
            <p class="muted">
              Denne siden leser direkte fra filene i <span class="mono">/data</span> og
              <span class="mono">/meta</span> pÃ¥ GitHub Pages, og viser derfor faktisk publisert tilstand â€“
              ikke bare Actions-loggene.
            </p>
            <p class="muted">
              Bruk dashboardet til Ã¥ bekrefte at:
            </p>
            <ul class="muted">
              <li>Speedlimits-delfiler finnes og har rimelig stÃ¸rrelse.</li>
              <li>Kolumbus-data er nylig oppdatert.</li>
              <li>Siste deploy ikke er eldre enn forventet.</li>
              <li>Datahash endrer seg nÃ¥r nye data publiseres.</li>
            </ul>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <span>
        Dashboard versjon <span id="dashboard-version">{{VERSION}}</span>
        &nbsp;â€¢&nbsp; hash <span class="mono" id="dashboard-hash">{{HASH}}</span>
      </span>
      <span>Bygget fra live data via GitHub Actions &amp; NVDB / Entur.</span>
    </footer>
  </div>

  <script src="dashboard/assets/dashboard.js"></script>
</body>
</html>
