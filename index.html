<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <title>Kolumbus â€“ SystemverktÃ¸y</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Global CSS -->
  <link rel="stylesheet" href="web/style.css" />
</head>

<body class="welcome-body">
  <div class="welcome-container">
    <div class="welcome-header">
      <h1>Kolumbus â€“ SystemverktÃ¸y</h1>
      <button id="theme-toggle" class="theme-toggle">ðŸŒ“</button>
    </div>

    <p class="welcome-subtitle">Velg et verktÃ¸y for Ã¥ fortsette</p>

    <div class="welcome-link-grid">
      <a class="welcome-link-btn" href="realtime.html">ðŸšŒ Sanntidskart (Kolumbus)</a>
      <a class="welcome-link-btn" href="web/test_speedlimits.html">ðŸš§ Testkart â€“ Fartsgrenser</a>
      <a class="welcome-link-btn" href="dashboard/status.html">ðŸ“Š Systemstatus Dashboard</a>
    </div>

    <div class="welcome-updated">
      Sist oppdatert: <span id="last-updated">Lasterâ€¦</span>
    </div>
  </div>

  <script>
    /* ---------------------------------------------------------
       THEME TOGGLE (dark/light mode)
    --------------------------------------------------------- */
    const html = document.documentElement;
    const toggle = document.getElementById("theme-toggle");

    const stored = localStorage.getItem("welcome-theme");
    if (stored === "dark" || stored === "light") {
      html.setAttribute("data-theme", stored);
    }

    toggle.addEventListener("click", () => {
      const current = html.getAttribute("data-theme") || "light";
      const next = current === "light" ? "dark" : "light";
      html.setAttribute("data-theme", next);
      localStorage.setItem("welcome-theme", next);
    });

    /* ---------------------------------------------------------
       LAST UPDATED INDICATOR
    --------------------------------------------------------- */
    async function loadLastUpdated() {
      try {
        const res = await fetch("meta/last_deploy.txt", { cache: "no-store" });
        if (!res.ok) throw new Error("Missing file");
        const epoch = parseInt((await res.text()).trim(), 10);
        const date = new Date(epoch * 1000);
        document.getElementById("last-updated").textContent =
          date.toISOString().replace("T", " ").replace("Z", " UTC");
      } catch {
        document.getElementById("last-updated").textContent = "ukjent";
      }
    }

    loadLastUpdated();
  </script>
</body>
</html>
